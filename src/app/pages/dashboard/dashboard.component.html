<div class="dashboard-container">
  <!-- Navigation Bar -->
  <nav class="navbar">
    <div class="nav-content">
      <div class="logo-section">
        <div class="logo-icon">ğŸª</div>
        <h1>Quáº£n LÃ½ Cá»­a HÃ ng</h1>
      </div>
      <div class="user-menu">
        <span class="user-name" *ngIf="user$ | async as user">
          {{ user.email }}
        </span>
        <button class="logout-btn" (click)="logout()">
          <span>ğŸšª</span> ÄÄƒng Xuáº¥t
        </button>
      </div>
    </div>
  </nav>

  <!-- Theft Alert Modal -->
  <div class="theft-alert-overlay" *ngIf="intruderAlert$ | async" [@fadeInOut]>
    <div class="theft-alert-modal">
      <div class="alert-header">
        <span class="alert-icon">ğŸš¨</span>
        <h2>{{ alertMessage }}</h2>
      </div>
      <div class="alert-body">
        <p>PhÃ¡t hiá»‡n hoáº¡t Ä‘á»™ng láº¡ táº¡i kho!</p>
        <p class="alert-time" *ngIf="alertTime">
          Thá»i gian: {{ alertTime | date: 'HH:mm:ss' }}
        </p>
      </div>
      <div class="alert-actions">
        <button class="btn-dismiss" (click)="dismissAlert()">ÄÃ³ng</button>
        <button class="btn-contact" (click)="dismissAlert()">TÃ´i Ä‘Ã£ biáº¿t</button>
      </div>
    </div>
  </div>

  <!-- Main Content -->
  <div class="content">
    <!-- Status Overview Section -->
    <div class="status-section" *ngIf="status$ | async as status">
      <!-- <div class="status-badge" [ngClass]="'status-' + status">
        <div class="status-dot"></div>
        <span class="status-label">{{ getStatusText(status) }}</span>
      </div> -->
      <div class="last-updated" *ngIf="lastUpdated$ | async as lastUpdated">
        Cáº­p nháº­t láº§n cuá»‘i: {{ lastUpdated | date: 'short' }}
      </div>
    </div>

    <!-- Loading State -->
    <div class="loading-container" *ngIf="isLoading$ | async">
      <div class="spinner"></div>
      <p>Äang táº£i dá»¯ liá»‡u cáº£m biáº¿n...</p>
    </div>

    <!-- Sensor Data Grid -->
    <div class="sensor-grid" *ngIf="!(isLoading$ | async)">
      <!-- Temperature Card -->
      <div class="sensor-card temperature-card">
        <div class="card-header">
          <h2>Nhiá»‡t Äá»™</h2>
          <span class="icon">ğŸŒ¡ï¸</span>
        </div>

        <div class="card-content" *ngIf="temperature$ | async as temp">
          <!-- Large Temperature Display -->
          <div class="temperature-display">
            <span class="value">{{ temp | number: '1.1-1' }}</span>
            <span class="unit">Â°C</span>
          </div>

          <!-- Temperature Gauge -->
          <div class="gauge-container">
            <div class="gauge-background">
              <div class="gauge-fill" [style.width.%]="getTemperatureGauge(temp)"
                [style.background]="getTemperatureFillColor(temp)">
              </div>
            </div>
            <div class="gauge-labels">
              <span>0Â°C</span>
              <span>25Â°C</span>
              <span>50Â°C</span>
            </div>
          </div>

          <!-- Status Indicator -->
          <div class="status-indicator" [ngClass]="getTemperatureStatus(temp)">
            <span class="status-dot"></span>
            {{ getTemperatureStatusText(temp) }}
          </div>

          <!-- Range Info -->
          <div class="range-info">
            <p class="optimal-range">
              <strong>Tá»‘i Æ¯u:</strong> 16Â°C - 26Â°C
            </p>
            <p class="warning-range">
              <strong>Cáº£nh BÃ¡o:</strong> 12Â°C - 30Â°C
            </p>
          </div>
        </div>
      </div>

      <!-- Humidity Card -->
      <div class="sensor-card humidity-card">
        <div class="card-header">
          <h2>Äá»™ áº¨m</h2>
          <span class="icon">ğŸ’§</span>
        </div>

        <div class="card-content" *ngIf="humidity$ | async as humidity">
          <!-- Large Humidity Display -->
          <div class="humidity-display">
            <span class="value">{{ humidity | number: '1.1-1' }}</span>
            <span class="unit">%</span>
          </div>

          <!-- Humidity Gauge -->
          <div class="gauge-container">
            <div class="gauge-background">
              <div class="gauge-fill" [style.width.%]="getHumidityGauge(humidity)"
                [style.background]="getHumidityFillColor(humidity)">
              </div>
            </div>
            <div class="gauge-labels">
              <span>0%</span>
              <span>50%</span>
              <span>100%</span>
            </div>
          </div>

          <!-- Status Indicator -->
          <div class="status-indicator" [ngClass]="getHumidityStatus(humidity)">
            <span class="status-dot"></span>
            {{ getHumidityStatusText(humidity) }}
          </div>

          <!-- Range Info -->
          <div class="range-info">
            <p class="optimal-range">
              <strong>Tá»‘i Æ¯u:</strong> 30% - 60%
            </p>
            <p class="warning-range">
              <strong>Cáº£nh BÃ¡o:</strong> 20% - 70%
            </p>
          </div>
        </div>
      </div>
    </div>

    <!-- Inventory Section -->
    <div class="inventory-section">
      <div class="inventory-header">
        <h2>ğŸ“¦ Quáº£n LÃ½ Kho</h2>
      </div>

      <div class="inventory-container">
        <!-- Current Inventory Card -->
        <div class="inventory-card current-inventory">
          <div class="card-header">
            <h3>Tá»“n Kho Hiá»‡n Táº¡i</h3>
            <span class="icon">ğŸ“Š</span>
          </div>
          <div class="card-content" *ngIf="currentInventory$ | async as inventory">
            <div class="inventory-value">
              <span class="value">{{ inventory }}</span>
              <span class="unit">Sáº£n pháº©m</span>
            </div>
          </div>
        </div>

        <!-- Inventory History -->
        <div class="inventory-card history-card">
          <div class="card-header">
            <h3>Lá»‹ch Sá»­ </h3>
            <span class="icon">ğŸ“œ</span>
          </div>
          <div class="card-content">
            <div class="loading-state" *ngIf="warehouseLoading$ | async">
              <div class="spinner"></div>
              <p>Äang táº£i lá»‹ch sá»­...</p>
            </div>

            <div class="history-list" *ngIf="!(warehouseLoading$ | async)">
              <div class="history-item" *ngFor="let transaction of inventoryHistory$ | async">
                <div class="transaction-header">
                  <div class="transaction-info">
                    <span class="transaction-type" [style.color]="getTransactionTypeColor(transaction.type)">
                      {{ transaction.type === 'NHAP' ? 'â•' : 'â–' }} {{ getTransactionTypeLabel(transaction.type) }}
                    </span>
                    <span class="transaction-date">{{ formatDate(transaction.date) }}</span>
                  </div>
                  <div class="transaction-amount" [style.color]="transaction.type === 'NHAP' ? '#4CAF50' : '#FF6F00'">
                    {{ transaction.type === 'NHAP' ? '+' : '-' }}{{ transaction.amount }}
                  </div>
                </div>
                <div class="transaction-details">
                  <span class="ton-sau">Tá»“n sau: <strong>{{ transaction.ton_sau }}</strong></span>
                </div>
              </div>

              <div class="empty-state" *ngIf="(inventoryHistory$ | async)?.length === 0">
                <p>ChÆ°a cÃ³ giao dá»‹ch nÃ o</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>