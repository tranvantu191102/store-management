<div class="dashboard-container">
  <!-- Navigation Bar -->
  <nav class="navbar">
    <div class="nav-content">
      <div class="logo-section">
        <div class="logo-icon">üè™</div>
        <h1>Qu·∫£n L√Ω Gi√°m S√°t Kho</h1>
      </div>
      <div class="user-menu">
        <span class="user-name" *ngIf="user$ | async as user">
          {{ user.email }}
        </span>
        <button class="logout-btn" (click)="logout()">
          <span>üö™</span> ƒêƒÉng Xu·∫•t
        </button>
      </div>
    </div>
  </nav>

  <!-- Theft Alert Modal -->
  <div class="theft-alert-overlay" *ngIf="intruderAlert$ | async" [@fadeInOut]>
    <div class="theft-alert-modal">
      <div class="alert-header">
        <span class="alert-icon">üö®</span>
        <h2>{{ alertMessage }}</h2>
      </div>
      <div class="alert-body">
        <p>Ph√°t hi·ªán ho·∫°t ƒë·ªông l·∫° t·∫°i kho!</p>
        <p class="alert-time" *ngIf="alertTime">
          Th·ªùi gian: {{ alertTime | date: 'HH:mm:ss' }}
        </p>
      </div>
      <div class="alert-actions">
        <button class="btn-dismiss" (click)="dismissAlert()">ƒê√≥ng</button>
        <button class="btn-contact" (click)="dismissAlert()">T√¥i ƒë√£ bi·∫øt</button>
      </div>
    </div>
  </div>

  <!-- Main Content -->
  <div class="content">
    <!-- Status Overview Section -->
    <div class="status-section" *ngIf="status$ | async as status">
      <!-- <div class="status-badge" [ngClass]="'status-' + status">
        <div class="status-dot"></div>
        <span class="status-label">{{ getStatusText(status) }}</span>
      </div> -->
      <div class="last-updated" *ngIf="lastUpdated$ | async as lastUpdated">
        C·∫≠p nh·∫≠t l·∫ßn cu·ªëi: {{ lastUpdated | date: 'short' }}
      </div>
    </div>

    <!-- Loading State -->
    <div class="loading-container" *ngIf="isLoading$ | async">
      <div class="spinner"></div>
      <p>ƒêang t·∫£i d·ªØ li·ªáu c·∫£m bi·∫øn...</p>
    </div>

    <!-- Sensor Data Grid -->
    <div class="sensor-grid" *ngIf="!(isLoading$ | async)">
      <!-- Temperature Card -->
      <div class="sensor-card temperature-card">
        <div class="card-header">
          <h2>Nhi·ªát ƒê·ªô</h2>
          <span class="icon">üå°Ô∏è</span>
        </div>

        <div class="card-content" *ngIf="temperature$ | async as temp">
          <!-- Large Temperature Display -->
          <div class="temperature-display">
            <span class="value">{{ temp | number: '1.1-1' }}</span>
            <span class="unit">¬∞C</span>
          </div>

          <!-- Temperature Gauge -->
          <div class="gauge-container">
            <div class="gauge-background">
              <div class="gauge-fill" [style.width.%]="getTemperatureGauge(temp)"
                [style.background]="getTemperatureFillColor(temp)">
              </div>
            </div>
            <div class="gauge-labels">
              <span>0¬∞C</span>
              <span>25¬∞C</span>
              <span>50¬∞C</span>
            </div>
          </div>

          <!-- Status Indicator -->
          <div class="status-indicator" [ngClass]="getTemperatureStatus(temp)">
            <span class="status-dot"></span>
            {{ getTemperatureStatusText(temp) }}
          </div>

          <!-- Range Info -->
          <div class="range-info">
            <p class="optimal-range">
              <strong>T·ªëi ∆Øu:</strong> 16¬∞C - 26¬∞C
            </p>
            <p class="warning-range">
              <strong>C·∫£nh B√°o:</strong> 12¬∞C - 30¬∞C
            </p>
          </div>
        </div>
      </div>

      <!-- Humidity Card -->
      <div class="sensor-card humidity-card">
        <div class="card-header">
          <h2>ƒê·ªô ·∫®m</h2>
          <span class="icon">üíß</span>
        </div>

        <div class="card-content" *ngIf="humidity$ | async as humidity">
          <!-- Large Humidity Display -->
          <div class="humidity-display">
            <span class="value">{{ humidity | number: '1.1-1' }}</span>
            <span class="unit">%</span>
          </div>

          <!-- Humidity Gauge -->
          <div class="gauge-container">
            <div class="gauge-background">
              <div class="gauge-fill" [style.width.%]="getHumidityGauge(humidity)"
                [style.background]="getHumidityFillColor(humidity)">
              </div>
            </div>
            <div class="gauge-labels">
              <span>0%</span>
              <span>50%</span>
              <span>100%</span>
            </div>
          </div>

          <!-- Status Indicator -->
          <div class="status-indicator" [ngClass]="getHumidityStatus(humidity)">
            <span class="status-dot"></span>
            {{ getHumidityStatusText(humidity) }}
          </div>

          <!-- Range Info -->
          <div class="range-info">
            <p class="optimal-range">
              <strong>T·ªëi ∆Øu:</strong> 30% - 60%
            </p>
            <p class="warning-range">
              <strong>C·∫£nh B√°o:</strong> 20% - 70%
            </p>
          </div>
        </div>
      </div>
    </div>

    <!-- Inventory Section -->
    <div class="inventory-section">
      <div class="inventory-header">
        <h2>üì¶ Qu·∫£n L√Ω Kho</h2>
      </div>

      <div class="inventory-container">
        <!-- Current Inventory Card -->
        <div class="inventory-card current-inventory">
          <div class="card-header">
            <h3>T·ªìn Kho Hi·ªán T·∫°i</h3>
            <span class="icon">üìä</span>
          </div>
          <div class="card-content" *ngIf="currentInventory$ | async as inventory">
            <div class="inventory-value">
              <span class="value">{{ inventory }}</span>
              <span class="unit">S·∫£n ph·∫©m</span>
            </div>
          </div>
        </div>

        <!-- Inventory History -->
        <div class="inventory-card history-card">
          <div class="card-header">
            <h3>L·ªãch S·ª≠ Giao D·ªãch</h3>
            <span class="icon">üìú</span>
          </div>
          <div class="card-content">
            <div class="loading-state" *ngIf="warehouseLoading$ | async">
              <div class="spinner"></div>
              <p>ƒêang t·∫£i l·ªãch s·ª≠...</p>
            </div>

            <div class="history-list" *ngIf="!(warehouseLoading$ | async)">
              <div class="history-item" *ngFor="let transaction of inventoryHistory$ | async">
                <div class="transaction-header">
                  <div class="transaction-info">
                    <span class="transaction-type" [style.color]="getTransactionTypeColor(transaction.type)">
                      {{ transaction.type === 'NHAP' ? '‚ûï' : '‚ûñ' }} {{ getTransactionTypeLabel(transaction.type) }}
                    </span>
                    <span class="transaction-date">{{ formatDate(transaction.date) }}</span>
                  </div>
                  <div class="transaction-amount" [style.color]="transaction.type === 'NHAP' ? '#4CAF50' : '#FF6F00'">
                    {{ transaction.type === 'NHAP' ? '+' : '-' }}{{ transaction.amount }}
                  </div>
                </div>
                <div class="transaction-details">
                  <span class="ton-sau">T·ªìn sau: <strong>{{ transaction.ton_sau }}</strong></span>
                </div>
              </div>

              <div class="empty-state" *ngIf="(inventoryHistory$ | async)?.length === 0">
                <p>Ch∆∞a c√≥ giao d·ªãch n√†o</p>
              </div>
            </div>
          </div>
        </div>

        <!-- Alarm History -->
        <div class="inventory-card history-card alarm-history">
          <div class="card-header">
            <h3>L·ªãch S·ª≠ C·∫£nh B√°o</h3>
            <span class="icon">üö®</span>
          </div>
          <div class="card-content">
            <div class="loading-state" *ngIf="warehouseLoading$ | async">
              <div class="spinner"></div>
              <p>ƒêang t·∫£i l·ªãch s·ª≠...</p>
            </div>

            <div class="history-list" *ngIf="!(warehouseLoading$ | async)">
              <div class="event-item alarm-event" *ngFor="let alarm of alarmHistory$ | async">
                <div class="event-icon" [style.color]="getEventColor(alarm.event)">üö®</div>
                <div class="event-details">
                  <div class="event-label" [style.color]="getEventColor(alarm.event)">
                    {{ getEventLabel(alarm.event) }}
                  </div>
                  <div class="event-timestamp">{{ formatTimestamp(alarm.timestamp) }}</div>
                </div>
              </div>

              <div class="empty-state" *ngIf="(alarmHistory$ | async)?.length === 0">
                <p>Ch∆∞a c√≥ c·∫£nh b√°o n√†o</p>
              </div>
            </div>
          </div>
        </div>

        <!-- Door History -->
        <div class="inventory-card history-card door-history">
          <div class="card-header">
            <h3>L·ªãch S·ª≠ M·ªü C·ª≠a</h3>
            <span class="icon">üö™</span>
          </div>
          <div class="card-content">
            <div class="loading-state" *ngIf="warehouseLoading$ | async">
              <div class="spinner"></div>
              <p>ƒêang t·∫£i l·ªãch s·ª≠...</p>
            </div>

            <div class="history-list" *ngIf="!(warehouseLoading$ | async)">
              <div class="event-item door-event" *ngFor="let door of doorHistory$ | async">
                <div class="event-icon" [style.color]="getEventColor(door.event)">üö™</div>
                <div class="event-details">
                  <div class="event-label" [style.color]="getEventColor(door.event)">
                    {{ getEventLabel(door.event) }}
                  </div>
                  <div class="event-timestamp">{{ formatTimestamp(door.timestamp) }}</div>
                </div>
              </div>

              <div class="empty-state" *ngIf="(doorHistory$ | async)?.length === 0">
                <p>Ch∆∞a c√≥ l·ªãch s·ª≠ m·ªü c·ª≠a</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>